<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <div id="click">clickme</div>
  </head>
  <body style="height:3000px">
    <script>
      window.addEventListener("popstate", (event) => {
        console.log(
          "location: " +
            document.location +
            ", state: " +
            JSON.stringify(event.state)
        );
      });
      const clickDom = document.querySelector("#click");
      clickDom.addEventListener('click',event=>{
    // 或者监听滚动来hack用户行为 
    //   document.addEventListener("scroll", (event) => {
        // 用户行为点击后再去塞state，就可以形成无限回不去场景
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
      });
      history.pushState({ page: 1 }, "title 1", "?page=1");
        // 初始化直接执行这波塞state是无效的，不会形成无限回不去
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
        // history.pushState({ page: 1 }, "title 1", "?page=1");
      history.pushState({ page: 1 }, "title 1", "?page=1");
      history.pushState({ page: 2 }, "title 2", "?page=2");
      // history.replaceState({page: 3}, "title 3", "?page=3");
      history.pushState({ page: 3 }, "title 3", "?page=3");
      console.warn(history);

      // history.back(); // Logs "location: http://example.com/example.html?page=1, state: {"page":1}"
      // history.back(); // Logs "location: http://example.com/example.html, state: null
      //history.go(2);  // Logs "location: http://example.com/example.html?page=3, state: {"page":3}
    </script>
  </body>
</html>
